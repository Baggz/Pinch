(function(){var k=function(a,b){return a.length!==b.length?!1:a.every(function(a,c){return b[c]===a})},j=function(a,b,d){var c,e;if("[object Array]"===Object.prototype.toString.call(a)){c=0;for(e=a.length;c<e;c++)b.apply(d,[c,a[c],a])}else for(c in a)a.hasOwnProperty(c)&&b.apply(d,[c,a[c],a])},h=/([a-zA-Z0-9\s]+)/g,g=function(a,b,d){var c=-1!==["string","object"].indexOf(typeof a),e="string"===typeof b||b&&b.test&&b.exec,f=-1!==["string","object","function"].indexOf(typeof d);c&&e&&f&&("string"===
typeof a?(this.instance=JSON.parse(a),this.json=!0):this.instance=a,this.pattern="string"===typeof b?b.replace(/'/g,'"'):b,this.replacement=d,this.createIndex(this.instance))};g.prototype.createIndex=function(a,b){var d=this;this.index=this.index||[];b=b||"";j(a,function(a,e){var f,a=a+"";f=a.match(/^[a-zA-Z]+$/)?b?b+"."+a:a:a.match(/\d+/)?b+"["+a+"]":b+'["'+a+'"]';d.index.push(f);"object"===typeof e&&d.createIndex(e,f)})};g.prototype.replace=function(){var a=this;j(this.index,function(b,d){if(a.pattern&&
a.pattern.test&&a.pattern.exec&&d.match(a.pattern))return a.replaceValue(d);if("string"===typeof a.pattern){var c=d.match(h),e=a.pattern.match(h);if(k(c,e))return a.replaceValue(d)}});return this.json?JSON.stringify(this.instance):this.instance};g.prototype.replaceValue=function(a){var b=this,d=a.match(h);d.reduce(function(c,e,f){if(f===d.length-1)f="function"===typeof b.replacement?b.replacement(a,e,c[e]):b.replacement,c[e]=f;else return c[e]},this.instance)};var i=function(a,b,d,c){a=(new g(a,b,
d)).replace();return"function"===typeof c?c(null,a):a};"undefined"!==typeof module&&module.exports?module.exports=i:"undefined"!==typeof define?define(function(){return i}):this.pinch=i})();